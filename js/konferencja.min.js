function start(){game=new Phaser.Game(800,600,backend,gameDivId),Loader={started:!1,preload:function(){Phaser.Device.desktop||(game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL),game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.game.scale.refresh(),game.load.image("background","assets/konferencja-bg.png"),game.load.image("tv_screen","assets/tv-obraz.png")},load_assets:function(){game.load.image("control_arrow_horiz","assets/szczalka-poziom.png"),game.load.image("control_arrow_vert","assets/szczalka-pion.png"),game.load.image("control_shoot","assets/button-hit.png"),game.load.image("curtain","assets/kurtyna.png"),game.load.image("floor","assets/podloga-wzorek.png"),game.load.image("scene","assets/scena.png"),game.load.image("laser","assets/laser.png"),game.load.image("papu","assets/falanga-cziken.png"),game.load.image("health","assets/health.png"),game.load.image("antoni_bg","assets/dym.png"),game.load.image("antoni","assets/antoni.png"),game.load.image("oczy","assets/oczy.png"),game.load.image("oko","assets/oko.png"),game.load.image("nuta","assets/nutki.png"),game.load.image("antoni_inside","assets/antoni-wnetrze.png"),game.load.image("antoni_jaw","assets/antoni-paszcza.png"),game.load.image("game_over","assets/game-over.png"),game.load.atlas("winnicki","assets/winnicki-jump.png","assets/winnicki-jump.json"),game.load.atlas("girl","assets/babeczka.png","assets/babeczka.json"),game.load.atlas("midget","assets/midget.png","assets/midget.json"),game.load.image("krucjator","assets/krucjator.png"),game.load.image("krucjator_eyebrows","assets/krucjator-brwi.png"),game.load.image("krucjator_mustache","assets/krucjator-wasik.png"),game.load.spritesheet("rydzyk","assets/rydzyk-4x1.png",50,73),game.load.spritesheet("explosion","assets/explode-128x128.png",128,128),game.load.spritesheet("bloody-splash","assets/bloody-splash-64x64.png",64,64),game.load.atlas("invader","assets/killer-pony.png","assets/killer-pony.json"),game.load.image("spit","assets/glut.png"),game.load.audio("boing","assets/boing.mp3"),game.load.audio("laser","assets/blaster.mp3"),game.load.audio("player_hit","assets/jeb.mp3"),game.load.audio("ding","assets/ding.mp3"),game.load.audio("dead_scream","assets/wilhelm-scream.mp3"),game.load.audio("health_bump","assets/health-bump.mp3"),game.load.audio("spit_start","assets/spit-start.mp3"),game.load.audio("spit_end","assets/spit-end.mp3"),game.load.audio("patataj","assets/patataj.mp3"),game.load.audio("metal_hit","assets/metal-hit.mp3"),game.load.audio("ping","assets/ping.mp3"),game.load.audio("fanfare","assets/fanfara.mp3"),game.load.audio("thunder","assets/thunder.mp3"),game.load.audio("hell_theme","assets/badalamenti-theme.mp3"),game.load.audio("bzium","assets/bzium.mp3"),game.load.audio("pop","assets/pop.mp3"),game.load.audio("antoni_scream","assets/aaa.mp3"),game.load.audio("antoni_growl","assets/dance.mp3"),game.load.audio("player_explosion","assets/player_explosion.mp3"),game.load.audio("teleport","assets/teleport.mp3"),game.load.audio("splat_0","assets/splat-0.mp3"),game.load.audio("splat_1","assets/splat-1.mp3"),game.load.audio("splat_2","assets/splat-2.mp3"),game.load.audio("splat_3","assets/splat-3.mp3"),game.load.audio("splat_4","assets/splat-4.mp3"),game.load.audio("splat_5","assets/splat-5.mp3"),game.load.audio("aww","assets/aww.mp3");for(var a=0;a<N_SPEECH_SOUNDS;a++)game.load.audio("speech_"+a,"assets/speech-"+a+".mp3");for(var a=0;a<N_SPEECH_YYY_SOUNDS;a++)game.load.audio("speech_yyy_"+a,"assets/speech-yyy-"+a+".mp3");game.load.start()},create:function(){game.stage.backgroundColor="#000",this.tv_screen=game.add.sprite(253,15,"tv_screen"),this.tv_screen.alpha=0,this.background=game.add.tileSprite(0,0,800,600,"background"),this.progress_bar=game.add.graphics(300,80),game.load.onFileComplete.add(this.fileLoaded,this),game.load.onLoadComplete.add(this.loadComplete,this),game.device.desktop||game.input.onDown.add(function(){game.scale.isFullScreen?game.scale.stopFullScreen():game.scale.startFullScreen(!1)},this),this.progress=0},update:function(){this.started?this.progress<1&&(this.progress_bar.clear(),this.progress_bar.lineStyle(15,16719872,1),this.progress_bar.moveTo(0,20),this.progress_bar.lineTo(200*this.progress,20)):(this.load_assets(),this.started=!0)},fileLoaded:function(a,b,c,d,e){this.progress=d/e},loadComplete:function(){this.snd_teleport=game.add.audio("teleport"),game.sound.setDecodedCallback([this.snd_teleport],this.start_game,this)},start_game:function(){tw=game.add.tween(this.progress_bar).to({alpha:0},500),tw.onComplete.add(function(){game.state.start("Main"),Loader.snd_teleport.play()},this),tw.start(),game.time.events.add(.25*Phaser.Timer.SECOND,function(){game.add.tween(this.tv_screen).to({alpha:1},250).start()},this)}},game.state.add("Loader",Loader),game.state.add("Main",konferencja),game.state.start("Loader")}var controller={_keyCursors:null,_keyFire:null,buttonLeft:!1,buttonRight:!1,buttonUp:!1,buttonDown:!1,buttonFire:!1,is_mobile:!1,isLeft:function(){if(this._keyCursors)return this._keyCursors.left.isDown||this.buttonLeft},isRight:function(){if(this._keyCursors)return this._keyCursors.right.isDown||this.buttonRight},isUp:function(){if(this._keyCursors)return this._keyCursors.up.isDown||this.buttonUp},isDown:function(){if(this._keyCursors)return this._keyCursors.down.isDown||this.buttonDown},isFire:function(){if(this._keyFire)return this._keyFire.isDown||this.buttonFire},setup:function(){game.device.desktop||(this.is_mobile=!0,this.setupMobile()),this._keyCursors=game.input.keyboard.createCursorKeys(),this._keyFire=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)},setupMobile:function(){game.input.addPointer(),game.input.addPointer(),game.input.addPointer(),game.input.addPointer();var a={x:200,y:100},b={x:100,y:100},c={x:0,y:100},d=function(a,b){a.fixedToCamera=!0,a.alpha=.5,a.anchor.setTo(.5,.5),a.angle=b};this.buttonfire=game.add.button(game.world.width-b.x/2,c.y+game.world.height/2,"control_shoot",null,this),d(this.buttonfire),this.buttonfire.events.onInputOver.add(function(){controller.buttonFire=!0}),this.buttonfire.events.onInputDown.add(function(){controller.buttonFire=!0}),this.buttonfire.events.onInputOut.add(function(){controller.buttonFire=!1}),this.buttonfire.events.onInputUp.add(function(){controller.buttonFire=!1}),this.controllerUp=game.make.button(c.x+a.x/2,c.y+(game.world.height-b.y-a.y)/2,"control_arrow_horiz",null,this),d(this.controllerUp,0),this.controllerUp.events.onInputOver.add(function(){controller.reset(),controller.buttonUp=!0}),this.controllerUp.events.onInputDown.add(function(){controller.reset(),controller.buttonUp=!0}),this.controllerUp.events.onInputOut.add(function(){controller.buttonUp=!1}),this.controllerUp.events.onInputUp.add(function(){controller.buttonUp=!1}),this.controllerDown=game.make.button(c.x+a.x/2,c.y+(game.world.height+b.y+a.y)/2,"control_arrow_horiz",null,this),d(this.controllerDown,180),this.controllerDown.events.onInputOver.add(function(){controller.reset(),controller.buttonDown=!0}),this.controllerDown.events.onInputDown.add(function(){controller.reset(),controller.buttonDown=!0}),this.controllerDown.events.onInputOut.add(function(){controller.buttonDown=!1}),this.controllerDown.events.onInputUp.add(function(){controller.buttonDown=!1}),this.controllerLeft=game.make.button(c.x+b.x/2,c.y+game.world.height/2,"control_arrow_vert",null,this),d(this.controllerLeft,180),this.controllerLeft.events.onInputOver.add(function(){controller.reset(),controller.buttonLeft=!0}),this.controllerLeft.events.onInputDown.add(function(){controller.reset(),controller.buttonLeft=!0}),this.controllerLeft.events.onInputOut.add(function(){controller.buttonLeft=!1}),this.controllerLeft.events.onInputUp.add(function(){controller.buttonLeft=!1}),this.controllerRight=game.make.button(c.x+1.5*b.x,c.y+game.world.height/2,"control_arrow_vert",null,this),d(this.controllerRight,0),this.controllerRight.events.onInputOver.add(function(){controller.reset(),controller.buttonRight=!0}),this.controllerRight.events.onInputDown.add(function(){controller.reset(),controller.buttonRight=!0}),this.controllerRight.events.onInputOut.add(function(){controller.buttonRight=!1}),this.controllerRight.events.onInputUp.add(function(){controller.buttonRight=!1}),this.controllerGroup=game.add.group(),this.controllerGroup.add(this.controllerUp),this.controllerGroup.add(this.controllerDown),this.controllerGroup.add(this.controllerLeft),this.controllerGroup.add(this.controllerRight)},reset:function(){controller.buttonLeft=!1,controller.buttonRight=!1,controller.buttonUp=!1,controller.buttonDown=!1,controller.buttonFire=!1,this.show()},show:function(){this.is_mobile&&(this.buttonfire.visible=!0,this.controllerLeft.visible=!0,this.controllerRight.visible=!0,this.controllerUp.visible=!0,this.controllerDown.visible=!0,game.world.bringToTop(this.buttonfire),game.world.bringToTop(this.controllerGroup))},hide:function(){this.is_mobile&&(this.controllerLeft.visible=!1,this.controllerRight.visible=!1,this.controllerUp.visible=!1,this.controllerDown.visible=!1,game.world.bringToTop(this.buttonfire))}},scene,cursors,keyJump,snd_boing,snd_teleport,all_sounds=[],sounds_ready=!1,scoreText,score=0,N_SPEECH_SOUNDS=25,N_SPEECH_YYY_SOUNDS=5,INITIAL_ACTION_DELAY=5e3,collectables={N:10,init_state:function(){this.pos_y=5,this.velocity=-75,this.enabled=!0,this.creation_time=game.time.now+INITIAL_ACTION_DELAY},reset:function(){this.init_state(),this.show()},create:function(){this.init_state(),this.sprite=game.add.group(),this.sprite.enableBody=!0,this.sprite.physicsBodyType=Phaser.Physics.ARCADE,this.sprite.createMultiple(this.N,"rydzyk",0),this.sprite.forEach(function(a){var b=a.animations.add("rydzyk",null,10,!0);b.setFrame(game.rnd.integerInRange(0,b.frameTotal)),a.body.allowGravity=!1,a.outOfBoundsKill=!0,a.checkWorldBounds=!0},this),this.hide_tween=game.add.tween(this.sprite).to({alpha:0},1e3),this.hide_tween.onComplete.add(function(){this.sprite.forEachAlive(function(a){a.kill()},this)},this)},init_physics:function(){},update:function(){game.time.now>this.creation_time&&this.enabled&&(c=this.sprite.getFirstExists(!1),c&&(c.reset(game.world.width-1,this.pos_y),c.body.velocity.x=this.velocity,c.play("rydzyk"),this.creation_time=game.time.now+game.rnd.integerInRange(2e3,1e4)-100*Math.log(Math.max(1,score))))},hide:function(){this.enabled=!1,this.hide_tween.start()},show:function(){this.enabled=!0,this.sprite.alpha=1}},collectable_health={N:1,NEW_ITEM_SCORE:3e4,EXPIRY_DELAY:15e3,init_state:function(){this.pos_y=300,this.creation_level=-1,this.expiry_time=0,this.scheduled=!1,this.velocity=-75,this.is_collectable=!1,this.player_low_health=!1,this.hit_sound_counter=0,this.enabled=!0},reset:function(){this.init_state()},create:function(){this.init_state(),this.sprite=game.add.group(),this.sprite.enableBody=!0,this.sprite.physicsBodyType=Phaser.Physics.ARCADE,this.sprite.createMultiple(this.N,"papu"),this.sprite.forEach(function(a){a.outOfBoundsKill=!0,a.checkWorldBounds=!0,a.anchor.y=1,a.fadeout=game.add.tween(a).to({alpha:0},100),a.scale_up=game.add.tween(a.scale).to({x:2,y:2},100),a.fadeout.onComplete.add(function(){a.kill()},this)},this),this.snd_fanfare=game.add.audio("fanfare"),all_sounds.push(this.snd_fanfare),this.snd_hit=game.add.audio("metal_hit"),all_sounds.push(this.snd_hit)},init_physics:function(){game.physics.arcade.enable(this.sprite),this.sprite.setAll("body.bounce.y",.7),this.sprite.setAll("body.drag.x",0),this.sprite.setAll("body.collideWorldBounds",!1),this.sprite.setAll("body.gravity.y",1e3)},update:function(){c=this.sprite.getFirstAlive(!1),c&&game.time.now>this.expiry_time?(c.fadeout.start(),c.scale_up.start(),this.is_collectable=!1):!c&&this.creation_level<konferencja.level&&this.player_low_health&&this.enabled&&(c=this.sprite.getFirstExists(!1),c&&(c.reset(600,1),c.scale.setTo(1,1),c.alpha=1,c.body.allowGravity=!0,this.expiry_time=game.time.now+this.EXPIRY_DELAY,this.creation_level=konferencja.level,this.is_collectable=!0,this.hit_sound_counter=0,this.snd_hit.volume=1,this.snd_fanfare.play()))},collect:function(a){a.fadeout.start(),a.scale_up.start(),this.is_collectable=!1,this.player_low_health=!1},hit_ground:function(a,b){sounds_ready&&this.hit_sound_counter<6&&(this.snd_hit.play("",0,1,!1,!0),this.snd_hit.volome*=.1,this.hit_sound_counter+=1)},hide:function(){this.enabled=!1},show:function(){this.enabled=!0}},winnicki={states:{WAITING:0,CROUCHING:1,JUMPING:2},COIN_BONUS:500,DOUBLE_SPLAT_BONUS:2e3,SPLAT_BONUS:500,KILL_PROJECTILE_BONUS:50,MAX_HEALTH:200,HEALTH_LOSS:10,LOW_HEALTH_THRESH:80,DOUBLE_SPLAT_TIME_WINDOW:200,INIT_X:170,INIT_Y:538,init_state:function(){this.shakeTimer=0,this.shootTimer=0,this.shakeX=0,this.state=this.states.WAITING,this.head_pos={x:0,y:0},this.last_state_change=0,this.is_shooting=!1,this.shoot_start_time=0,this.last_splat_time=0,this.health=this.MAX_HEALTH,this.isDead=!1},reset:function(){this.init_state(),this.sprite.reset(-this.sprite.width/2,this.INIT_Y),this.sprite.frame=0,this.sprite.scale.setTo(1,1),this.sprite.body.collideWorldBounds=!0,this.sprite.body.enable=!1;var a=game.add.tween(this.sprite).to({x:this.INIT_X},200,Phaser.Easing.Quadratic.Out);a.onComplete.add(function(){this.sprite.body.enable=!0,controller.show()},this),a.start()},create:function(){this.sprite=game.add.sprite(this.INIT_X,this.INIT_Y,"winnicki"),this.sprite.anchor.x=.5,this.sprite.anchor.y=1,this.sprite.alpha=0,game.add.tween(this.sprite).to({alpha:1},500).start(),this.init_state(),this.anim_crouch=this.sprite.animations.add("crouch",Phaser.Animation.generateFrameNames("winnicki-jump",0,3,"",4),30,!1),this.anim_jump=this.sprite.animations.add("jump",Phaser.Animation.generateFrameNames("winnicki-jump",4,5,"",4),25,!1),this.anim_jump.onComplete.add(this.make_jump,this),this.health_bump=game.add.tween(this.sprite.scale).to({x:1.25,y:1.25},300,Phaser.Easing.Quadratic.Out,!1,0,0,!0),this.explosions=game.add.group(),this.explosions.createMultiple(10,"explosion"),this.explosions.forEach(function(a){a.animations.add("explosion"),a.anchor.x=1,a.anchor.y=.5},this),this.splashes=game.add.group(),this.splashes.createMultiple(5,"bloody-splash"),this.splashes.forEach(function(a){a.animations.add("bloody-splash"),a.anchor.x=1,a.anchor.y=0,a.scale.x=1.3,a.scale.y=1.3},this),this.projectiles=game.add.group(),this.projectiles.enableBody=!0,this.projectiles.physicsBodyType=Phaser.Physics.ARCADE,this.projectiles.createMultiple(10,"spit",0),this.projectiles.forEach(function(a){a.anchor.x=.5,a.anchor.y=.5,a.outOfBoundsKill=!0,a.checkWorldBounds=!0,a.body.gravity.y=800,a.body.bounce.setTo(0,0),a.body.setSize(2,2,0,0),a.fadeout=game.add.tween(a).to({alpha:0},1e3),a.fadeout.onComplete.add(function(){a.kill()},this)},this),this.snd_hit=game.add.audio("player_hit"),this.snd_ding=game.add.audio("ding"),this.snd_dead_scream=game.add.audio("dead_scream"),this.snd_splat_floor=game.add.audio("splat_0"),this.snd_splat=game.add.audio("splat_1"),this.snd_splat_bonus=game.add.audio("splat_2"),this.snd_health_bump=game.add.audio("health_bump"),this.snd_spit_start=game.add.audio("spit_start"),this.snd_spit_end=game.add.audio("spit_end"),this.snd_aww=game.add.audio("aww"),this.snd_explosion=game.add.audio("player_explosion"),all_sounds.push(this.snd_hit),all_sounds.push(this.snd_ding),all_sounds.push(this.snd_dead_scream),all_sounds.push(this.snd_splat),all_sounds.push(this.snd_splat_bonus),all_sounds.push(this.snd_splat_floor),all_sounds.push(this.snd_health_bump),all_sounds.push(this.snd_spit_start),all_sounds.push(this.snd_spit_end),all_sounds.push(this.snd_aww),all_sounds.push(this.snd_explosion)},init_physics:function(){game.physics.arcade.enable(this.sprite),this.sprite.body.bounce.y=0,this.sprite.body.drag.x=100,this.sprite.body.collideWorldBounds=!0,this.sprite.body.gravity.y=1e3,this.sprite.body.maxVelocity.y=500,this.squeeze_body(10)},change_state:function(a){this.state=a,this.last_state_change=game.time.now},squeeze_body:function(a){var b=this.sprite.width/2,c=this.sprite.height-a;this.sprite.body.setSize(b,c,0,0)},make_jump:function(){this.state==this.states.JUMPING&&(snd_boing.play(),this.sprite.body.velocity.y=-500)},touchedGround:function(){this.state==this.states.JUMPING&&this.anim_jump.isFinished&&this.change_state(this.states.WAITING)},update:function(){this.sprite.body.velocity.x=0,this.head_pos.x=this.sprite.body.x+50,this.head_pos.y=this.sprite.body.y+50,game.time.now<this.shakeTimer?(this.sprite.body.x+=Math.sin(this.shakeX),this.shakeX+=.8):this.sprite.tint=16777215,controller.isLeft()&&this.state==this.states.JUMPING?this.sprite.body.velocity.x=-250:controller.isRight()&&this.state==this.states.JUMPING&&(this.sprite.body.velocity.x=250),controller.isDown()&&this.state==this.states.WAITING&&(this.change_state(this.states.CROUCHING),this.squeeze_body(150),this.anim_crouch.play()),controller.isDown()||this.state!=this.states.CROUCHING||(this.change_state(this.states.WAITING),this.squeeze_body(10),this.anim_jump.play()),(controller.isUp()||controller.isLeft()||controller.isRight())&&this.state==this.states.WAITING&&(this.change_state(this.states.JUMPING),this.anim_jump.play()),controller.isFire()&&!this.is_shooting&&sounds_ready&&(this.is_shooting=!0,this.shoot_start_time=game.time.now,this.snd_spit_start.play()),!controller.isFire()&&this.is_shooting&&(this.shoot(),this.is_shooting=!1),this.health<this.LOW_HEALTH_THRESH&&(collectable_health.player_low_health=!0)},shoot:function(){var a=this.projectiles.getFirstExists(!1);if(a){a.info={},this.snd_spit_start.stop(),this.snd_spit_end.play();var b=0;this.state==this.states.CROUCHING&&(b=80),a.reset(this.sprite.x+30,this.sprite.y-this.sprite.height+50+b),game.world.bringToTop(this.projectiles),a.alpha=1,a.rotation=0,a.body.enable=!0;var c=Math.min(300,Math.max(130,(game.time.now-this.shoot_start_time)/2));a.body.velocity.x=c+this.sprite.body.velocity.x,a.body.velocity.y=this.sprite.body.velocity.y,a.scale.setTo(.8+.3*c/300)}},shot_hit_something:function(a,b){b.fadeout.isRunning||b.fadeout.start(),b.body.enable=!1,sounds_ready&&this.snd_splat_floor.play()},shot_hit_shot:function(a,b){a.kill(),b.kill(),sounds_ready&&this.snd_splat_floor.play()},hitByBullet:function(a,b){var c=this.explosions.getFirstExists(!1);c&&(c.reset(b.x,b.y),c.play("explosion",30,!1,!0),sounds_ready&&(this.snd_hit.play(),this.startShaking())),b.kill(),this.health-=this.HEALTH_LOSS,this.health<=0&&this.game_over()},hitByProjectile:function(a,b){if(this.sprite.body.velocity.y<=0)this.hitByBullet(this,b);else{var c=!1;if(game.time.now-this.last_splat_time<this.DOUBLE_SPLAT_TIME_WINDOW?(c=!0,score+=this.DOUBLE_SPLAT_BONUS):score+=this.SPLAT_BONUS,this.last_splat_time=game.time.now,sounds_ready){var d=this.snd_splat;if(c){d=this.snd_splat_bonus,this.snd_aww.play();var e=game.add.text(b.x,b.y,"+".concat(this.DOUBLE_SPLAT_BONUS.toString()),{font:"32px Dimitri",fill:"#fff"}),f=game.add.tween(e).to({y:b.y-200,alpha:0},2e3,Phaser.Easing.Quadratic.In);f.onComplete.add(function(){e.kill()},this),f.start()}d.play()}cursors.down.isUp&&(this.anim_crouch.play(),this.anim_crouch.onComplete.addOnce(function(){this.change_state(this.states.WAITING),this.anim_jump.play()},this)),this.splash_enemy_projectile(b)}},splash_enemy_projectile:function(a){var b=this.splashes.getFirstExists(!1);b&&(b.reset(a.x-10,a.y),game.world.bringToTop(b),b.play("bloody-splash",15,!1,!0)),a.kill()},startShaking:function(){this.shakeTimer=game.time.now+1500,this.shakeX=0,this.sprite.tint=16777024},gotCollectable:function(a,b){score+=this.COIN_BONUS,b.body.velocity.x=0,b.body.velocity.y=-500,sounds_ready&&this.snd_ding.play()},gotHealth:function(a,b){collectable_health.is_collectable&&(collectable_health.collect(b),sounds_ready&&this.snd_ding.play(),this.health=this.MAX_HEALTH,this.health_bump.start(),this.snd_health_bump.play())},game_over:function(){this.isDead||(this.isDead=!0,game.world.bringToTop(this.sprite),this.sprite.body.collideWorldBounds=!1,this.sprite.body.velocity.y=-500,this.sprite.body.velocity.x=100,game.add.tween(this.sprite.scale).to({x:1.3,y:1.3},2e3).start(),sounds_ready&&this.snd_dead_scream.play(),collectables.hide(),game.time.events.add(3*Phaser.Timer.SECOND,this.player_hits_bottom,this))},player_hits_bottom:function(){this.snd_explosion.play("","",.3),game.time.events.add(1*Phaser.Timer.SECOND,game_over_screen.show,game_over_screen)}},krucjator={SND_VOLUME:.85,EYEBROW_MOVEMENT_RATE:3e3,MUSTACHE_MOVEMENT_RATE:200,SPEECH_DELAY:2e3,init_state:function(){this.init_pos={x:340,y:140},this.eyebrows_offset={x:48,y:22},this.mustache_offset={x:56,y:43},this.is_first_speech=!0,this.active=!0,this.speech_timer=game.time.now+1e3,this.eyebrow_timer=game.time.now+this.EYEBROW_MOVEMENT_RATE,this.mustache_timer=game.time.now+this.MUSTACHE_MOVEMENT_RATE},reset:function(){this.init_state(),this.snd_speech.stop(),this.snd_speech=this.snd_speech_parts[0]},create:function(){this.init_state(),this.sprite=game.add.sprite(this.init_pos.x,this.init_pos.y,"krucjator"),this.eyebrows=game.add.sprite(this.init_pos.x+this.eyebrows_offset.x,this.init_pos.y+this.eyebrows_offset.y,"krucjator_eyebrows"),this.mustache=game.add.sprite(this.init_pos.x+this.mustache_offset.x,this.init_pos.y+this.mustache_offset.y,"krucjator_mustache"),this.sprite.alpha=0,game.add.tween(this.sprite).to({alpha:1},500).start(),this.eyebrows.alpha=0,game.add.tween(this.eyebrows).to({alpha:1},500).start(),this.mustache.alpha=0,game.add.tween(this.mustache).to({alpha:1},500).start(),this.snd_speech_parts=[],this.snd_speech_yyy=[];for(var a=0;a<N_SPEECH_SOUNDS;a++){var b=game.add.audio("speech_"+a);b.volume=this.SND_VOLUME,all_sounds.push(b),this.snd_speech_parts.push(b)}for(var a=0;a<N_SPEECH_YYY_SOUNDS;a++){var b=game.add.audio("speech_yyy_"+a);b.volume=this.SND_VOLUME,all_sounds.push(b),this.snd_speech_yyy.push(b)}this.snd_speech=this.snd_speech_parts[0]},init_physics:function(){},update:function(){if(this.active){if(this.is_first_speech&&sounds_ready&&(this.snd_speech.play(),this.speech_timer=game.time.now+1e3*this.snd_speech.duration+this.SPEECH_DELAY,this.is_first_speech=!1),!this.snd_speech.isPlaying&&game.time.now>this.speech_timer&&sounds_ready){var a=this.snd_speech_parts;Math.random()>.5&&(a=this.snd_speech_yyy),this.snd_speech=a[Math.round((a.length-1)*Math.random())],this.speech_timer=game.time.now+1e3*this.snd_speech.duration+this.SPEECH_DELAY*(.75+.25*Math.random()),this.snd_speech.play()}game.time.now>this.eyebrow_timer&&(this.eyebrows.y=this.init_pos.y+this.eyebrows_offset.y+game.rnd.integerInRange(-1,2),this.eyebrow_timer=game.time.now+game.rnd.integerInRange(500,this.EYEBROW_MOVEMENT_RATE)),this.snd_speech.isPlaying&&game.time.now>this.mustache_timer&&(this.mustache.y=this.init_pos.y+this.mustache_offset.y+game.rnd.integerInRange(-2,0),this.mustache_timer=game.time.now+game.rnd.integerInRange(50,this.MUSTACHE_MOVEMENT_RATE))}},set_visible:function(a){this.sprite.visible=a,this.eyebrows.visible=a,this.mustache.visible=a},set_active:function(a){this.active=a},is_playing:function(){return this.snd_speech.isPlaying}},redrum={HELL_ANIM_SCORE:2e4,EYES_HIT_BONUS:2e4,HELL_DURATION:3e4,MIDGET_DANCE_TIME:15e3,BG_FADE_DURATION:3e3,MELODY_HALF_NOTE:1094,DANCE_MOVE_TOLERANCE:150,ANTONI_JAW_OFFSET:8,NOTES_NEEDED:4,PING_SND_DELAY:50,PING_SND_PLAY_LIMIT:20,is_active:!1,action_cnt:0,action_timer:0,melody_timer:0,melody_counter:0,note_shown_counter:0,last_melody_time:0,note_pos:{x:50,y:-450},notes_shown:0,midget_init_pos:{x:50,y:535},midget_speed:100,midget_visible:!1,eyes_hit:!1,antoni_jaw_pos:{x:368,y:137},last_ping_time:0,ping_snd_cnt:0,actions:[function(){return krucjator.set_active(!1),krucjator.set_visible(!1),1e3},function(){return krucjator.set_visible(!0),500},function(){return krucjator.set_visible(!1),500},function(){return krucjator.set_visible(!0),200},function(){return krucjator.set_visible(!1),1e3},function(){return this.snd_thunder.play(),2e3},function(){return konferencja.level+=1,this.eyes_hit=!1,this.ping_snd_cnt=0,this.antoni_jaw.reset(this.antoni_jaw_pos.x,this.antoni_jaw_pos.y),krucjator.set_visible(!1),this.reset_eyes(),this.floor.emerge.start(),this.curtain.emerge.start(),this.tv_screen.disappear.start(),collectable_health.hide(),collectables.hide(),score_text.hide(),konferencja.hide_health(),this.BG_FADE_DURATION/2},function(){return this.snd_melody.fadeIn(this.BG_FADE_DURATION,!0),this.melody_timer=this.MELODY_HALF_NOTE/2,this.melody_counter=0,this.note_shown_counter=0,this.notes_shown=0,game.time.events.add(Phaser.Timer.SECOND*(5+7*Math.random()),function(){if(!this.midget_visible){this.snd_antoni_growl.play();var a=game.add.tween(this.antoni_jaw).to({y:this.antoni_jaw.y+6},150,Phaser.Easing.Quadratic.Out);a.onComplete.add(function(){var a=game.add.tween(this.antoni_jaw).to({y:this.antoni_jaw.y+6},150,Phaser.Easing.Quadratic.Out);a.yoyo(!0,100),a.onComplete.add(function(){var a=game.add.tween(this.antoni_jaw).to({y:this.antoni_jaw.y+3},300,Phaser.Easing.Quadratic.Out);a.yoyo(!0,0),a.start()},this),a.start()},this),a.yoyo(!0,30),a.start()}},this),this.HELL_DURATION},function(){return this.floor.disappear.start(),this.curtain.disappear.start(),this.midget.disappear.start(),this.mobile_eyes.disappear.start(),this.tv_screen.emerge.start(),this.snd_melody.fadeOut(this.BG_FADE_DURATION),this.melody_timer=0,1e3},function(){return krucjator.set_visible(!0),300},function(){return krucjator.set_visible(!1),1e3},function(){return krucjator.set_visible(!0),100},function(){return krucjator.set_visible(!1),100},function(){return krucjator.set_visible(!0),this.BG_FADE_DURATION-1400},function(){return collectable_health.show(),collectables.show(),score_text.show(!1),konferencja.show_health(),krucjator.set_active(!0),this.target_score+=(konferencja.level+1)*this.HELL_ANIM_SCORE,this.anim_midget_dance.stop(),this.hide_midget(),0}],reset_eyes:function(){this.eyes.visible=!0,this.mobile_eyes.visible=!1,this.mobile_eyes.setAll("body.enable",!1)},reset:function(){this.target_score=this.HELL_ANIM_SCORE,this.ping_snd_cnt=0},create:function(){this.tv_screen=game.add.sprite(253,15,"tv_screen"),game.world.sendToBack(this.tv_screen),this.tv_screen.emerge=game.add.tween(this.tv_screen).to({alpha:1},this.BG_FADE_DURATION),this.tv_screen.disappear=game.add.tween(this.tv_screen).to({alpha:0},this.BG_FADE_DURATION),this.antoni_jaw=game.add.sprite(368,137,"antoni_jaw"),game.world.sendToBack(this.antoni_jaw),this.antoni=game.add.sprite(280,30,"antoni"),game.world.sendToBack(this.antoni),this.eye_center_x=364,this.eye_center_y=88,this.eyes=game.add.sprite(this.eye_center_x,this.eye_center_y,"oczy"),game.world.sendToBack(this.eyes),this.antoni_inside=game.add.sprite(280,30,"antoni_inside"),game.world.sendToBack(this.antoni_inside),this.mobile_eyes=game.add.group(),this.mobile_eyes.createMultiple(2,"oko",0),this.mobile_eyes.visible=!1,this.mobile_eyes.disappear=game.add.tween(this.mobile_eyes).to({alpha:0},this.BG_FADE_DURATION),this.antoni_bg=game.add.sprite(250,15,"antoni_bg"),game.world.sendToBack(this.antoni_bg),this.floor=game.add.sprite(0,439,"floor"),this.floor.alpha=0,this.floor.emerge=game.add.tween(this.floor).to({alpha:1},this.BG_FADE_DURATION),this.floor.disappear=game.add.tween(this.floor).to({alpha:0},this.BG_FADE_DURATION),this.curtain=game.add.sprite(0,0,"curtain"),this.curtain.alpha=0,this.curtain.emerge=game.add.tween(this.curtain).to({alpha:1},this.BG_FADE_DURATION),this.curtain.disappear=game.add.tween(this.curtain).to({alpha:0},this.BG_FADE_DURATION),this.midget=game.add.sprite(this.midget_init_pos.x,this.midget_init_pos.y,"midget"),this.midget.alpha=0,this.midget.anchor.x=.5,this.midget.anchor.y=1,this.midget.scale.setTo(.7,.7),this.midget.emerge=game.add.tween(this.midget).to({alpha:1},this.BG_FADE_DURATION),this.midget.disappear=game.add.tween(this.midget).to({alpha:0},this.BG_FADE_DURATION),this.anim_midget_dance=this.midget.animations.add("dance",Phaser.Animation.generateFrameNames("kaczy-taniec",0,9,"",4),9,!0),this.note=game.add.sprite(0,0,"nuta"),this.note.visible=!1,this.snd_thunder=game.add.audio("thunder"),this.snd_melody=game.add.audio("hell_theme"),this.snd_ricochet=game.add.audio("bzium"),this.snd_pop=game.add.audio("pop"),this.snd_ping=game.add.audio("ping"),this.snd_antoni_scream=game.add.audio("antoni_scream"),this.snd_antoni_growl=game.add.audio("antoni_growl"),all_sounds.push(this.snd_thunder),all_sounds.push(this.snd_melody),all_sounds.push(this.snd_ricochet),all_sounds.push(this.snd_pop),all_sounds.push(this.snd_ping),all_sounds.push(this.snd_antoni_scream),all_sounds.push(this.snd_antoni_growl),this.snd_melody.onLoop.add(function(){this.melody_timer=this.MELODY_HALF_NOTE/2},this),this.target_score=this.HELL_ANIM_SCORE},init_physics:function(){game.physics.arcade.enable(this.eyes),this.eyes.body.allowGravity=!1,game.physics.arcade.enable(this.mobile_eyes),this.mobile_eyes.forEach(function(a){a.anchor.x=.5,a.anchor.y=.5,a.outOfBoundsKill=!0,a.checkWorldBounds=!0,a.body.allowGravity=!0,a.body.gravity.y=800,a.body.bounce.setTo(.8,.8),a.body.setSize(2,2,0,0)},this),game.physics.arcade.enable(this.midget),this.midget.body.bounce.y=0,this.midget.body.drag.x=100,this.midget.body.collideWorldBounds=!1,this.midget.body.gravity.y=1e3,this.midget.body.maxVelocity.y=500,game.world.bringToTop(this.midget),controller.show();var a=.7*this.midget.body.width,b=this.midget.body.height+40;this.midget.body.setSize(a,b,0,-10),this.anim_midget_dance.onLoop.add(function(){this.midget.body.velocity.x=this.midget_speed},this)},spit_hits_midget:function(a,b){b.info.bounced_off_midget=!0,b.body.velocity.x*=-1,b.body.velocity.y*=-1.2,b.rotation=-135,this.snd_ricochet.play()},spit_hits_eye:function(a,b){if(b.info.bounced_off_midget&&!this.eyes_hit){this.eyes_hit=!0,this.eyes.visible=!1,this.mobile_eyes.visible=!0,this.mobile_eyes.alpha=1,this.mobile_eyes.setAll("body.enable",!0);var c=this.mobile_eyes.getAt(0),d=this.mobile_eyes.getAt(1);c.reset(this.eyes.x,this.eyes.y),d.reset(c.x+50,c.y),game.world.bringToTop(this.mobile_eyes),c.body.velocity.setTo(.2*b.body.velocity.x,.2*b.body.velocity.y);var e=.2+.2*Math.random();d.body.velocity.setTo(b.body.velocity.x*e,b.body.velocity.y*e),this.snd_pop.play(),b.body.enable=!1,b.fadeout.start();var f=game.add.text(this.eyes.x+50,this.eyes.y,"+"+this.EYES_HIT_BONUS/1e3+".000",{font:"32px Dimitri",fill:"#fff"}),g=game.add.tween(f).to({y:this.eyes.y-200,alpha:0},2e3,Phaser.Easing.Quadratic.In);g.onComplete.add(function(){f.kill()},this),g.start(),score+=this.EYES_HIT_BONUS,this.target_score+=this.EYES_HIT_BONUS,game.time.events.add(.5*Phaser.Timer.SECOND,function(){this.snd_antoni_scream.play();var a=game.add.tween(this.antoni_jaw).to({y:this.antoni_jaw.y+this.ANTONI_JAW_OFFSET},150);a.start()},this),game.time.events.add(1*Phaser.Timer.SECOND,function(){var a=game.add.tween(this.antoni_jaw).to({y:this.antoni_jaw_pos.y},150);a.start(),winnicki.snd_aww.play()},this)}},eyes_hit_ground:function(a,b){sounds_ready&&game.time.now-this.last_ping_time>this.PING_SND_DELAY&&this.ping_snd_cnt<this.PING_SND_PLAY_LIMIT&&(this.snd_ping.play(),this.last_ping_time=game.time.now,this.ping_snd_cnt+=1)},update:function(){!this.is_active&&score>=this.target_score&&!krucjator.is_playing()&&sounds_ready&&!winnicki.isDead&&(this.is_active=!0,this.action_timer=game.time.now),this.is_active&&(game.time.now>=this.action_timer&&(this.action_cnt<this.actions.length&&(phase_duration=this.actions[this.action_cnt].call(this),this.action_timer=game.time.now+phase_duration,this.action_cnt+=1),this.action_cnt==this.actions.length&&(this.is_active=!1,this.action_cnt=0)),this.midget_visible&&game.physics.arcade.collide(this.midget,scene),game.physics.arcade.overlap(this.eyes,winnicki.projectiles,this.spit_hits_eye,null,this),this.eyes_hit?game.physics.arcade.collide(this.mobile_eyes,scene,this.eyes_hit_ground,null,this):(this.eyes.x=this.calc_eye_offset(this.eye_center_x,winnicki.head_pos.x),
this.eyes.y=this.calc_eye_offset(this.eye_center_y,winnicki.head_pos.y)),this.melody_timer>0&&this.snd_melody.currentTime>=this.melody_timer&&(this.melody_counter+=1,this.melody_timer+=this.MELODY_HALF_NOTE,this.last_melody_time=game.time.now),this.snd_melody.isPlaying&&this.note_shown_counter!=this.melody_counter&&winnicki.state==winnicki.states.CROUCHING&&Math.abs(winnicki.last_state_change-this.last_melody_time)<this.DANCE_MOVE_TOLERANCE&&(0==this.notes_shown?(this.notes_counting_from=this.melody_counter,this.notes_shown+=1):this.melody_counter-this.notes_counting_from!=this.notes_shown?this.notes_shown=0:this.notes_shown+=1,this.show_note(),this.note_shown_counter=this.melody_counter),this.notes_shown!=this.NOTES_NEEDED||this.midget_visible||this.show_midget())},show_midget:function(){this.midget_visible=!0,game.world.bringToTop(this.midget),controller.show(),this.midget.alpha=0,this.midget.reset(this.midget_init_pos.x,this.midget_init_pos.y),this.midget.emerge.start(),this.midget.body.velocity.x=this.midget_speed,this.anim_midget_dance.play(),this.action_timer=game.time.now+this.MIDGET_DANCE_TIME},hide_midget:function(){this.midget.reset(this.midget_init_pos.x,this.midget_init_pos.y),this.midget.body.velocity.x=0,this.midget_visible=!1},show_note:function(){this.note.x=winnicki.sprite.x+this.note_pos.x,this.note.y=winnicki.sprite.y+this.note_pos.y,this.note.alpha=1,this.note.visible=!0,this.note.scale.setTo(.7,.7);var a=game.add.tween(this.note).to({alpha:0,x:this.note.x+50,y:this.note.y-50},.75*this.MELODY_HALF_NOTE,Phaser.Easing.Quadratic.In);a.onComplete.addOnce(function(){this.note.visible=!1},this),a.start()},calc_eye_offset:function(a,b){var c=(b-a)/Math.max(a,b);return a+3*c}},girl={LASER_SPEED:350,THROW_SPEED:150,JUMP_DELAY:3e3,SHOOT_DELAY:1800,MIN_DELAY:400,DELAY_STEP:300,INIT_POS:{x:540,y:102},release_animation:function(){this.anim_busy=!1},init_state:function(){this.anim_throw_frame=0,this.anim_busy=!1,this.double_throw=!1,this.jumpTimer=game.time.now+this.JUMP_DELAY+INITIAL_ACTION_DELAY,this.shootTimer=game.time.now+this.SHOOT_DELAY+INITIAL_ACTION_DELAY},reset:function(){this.init_state(),game.add.tween(this.sprite).to(this.INIT_POS,500),this.sprite.body.enable=!1;var a=game.add.tween(this.sprite).to(this.INIT_POS,300,Phaser.Easing.Quadratic.Out);a.onComplete.add(function(){this.sprite.body.enable=!0},this),a.start()},create:function(){this.init_state(),this.sprite=game.add.sprite(540,102,"girl"),this.sprite.alpha=0,game.add.tween(this.sprite).to({alpha:1},500).start(),this.anim_jump=this.sprite.animations.add("jump",Phaser.Animation.generateFrameNames("babeczka",0,2,"",4),15,!1),this.anim_jump.onComplete.add(this.release_animation,this),this.anim_jump.onComplete.add(function(){this.make_jump()},this),this.anim_throw=this.sprite.animations.add("throw",Phaser.Animation.generateFrameNames("babeczka",2,6,"",4),15,!1),this.anim_throw.enableUpdate=!0,this.anim_throw.onUpdate.add(this.throwit,this),this.anim_throw.onComplete.add(this.release_animation,this),this.anim_scream=this.sprite.animations.add("scream",Phaser.Animation.generateFrameNames("babeczka",5,12,"",4),14,!1),this.anim_scream.onComplete.add(this.release_animation,this),this.bullets=game.add.group(),this.bullets.enableBody=!0,this.bullets.physicsBodyType=Phaser.Physics.ARCADE,this.bullets.createMultiple(5,"laser"),this.bullets.setAll("anchor.x",1),this.bullets.setAll("anchor.y",.5),this.bullets.setAll("body.allowGravity",!1),this.bullets.setAll("outOfBoundsKill",!0),this.bullets.setAll("checkWorldBounds",!0),this.snd_shot=game.add.audio("laser"),this.snd_shot.volume=.3,this.snd_player_touch=game.add.audio("splat_4"),this.snd_horse_walk=game.add.audio("patataj"),this.snd_splat=game.add.audio("splat_3"),all_sounds.push(this.snd_shot),all_sounds.push(this.snd_player_touch),all_sounds.push(this.snd_horse_walk),all_sounds.push(this.snd_splat),this.projectiles=game.add.group(),this.projectiles.enableBody=!0,this.projectiles.physicsBodyType=Phaser.Physics.ARCADE,this.projectiles.createMultiple(5,"invader",0),this.projectiles.setAll("anchor.x",1),this.projectiles.setAll("anchor.y",0),this.projectiles.setAll("outOfBoundsKill",!0),this.projectiles.setAll("checkWorldBounds",!0),this.projectiles.forEach(function(a){var b=a.body.width/2,c=a.body.height/2;a.body.setSize(b,c,-b/2,c),a.animations.add("run",Phaser.Animation.generateFrameNames("rainbow-pony_gif",0,15,"",4),30,!0),a.scale_up=game.add.tween(a.scale).to({x:1,y:1},1e3,Phaser.Easing.Quadratic.Out),a.play("run"),a.events.onKilled.add(function(){this.snd_horse_walk.stop()},this)},this)},init_physics:function(){game.physics.arcade.enable(this.sprite),this.sprite.body.bounce.y=.1,this.sprite.body.drag.x=300,this.sprite.body.collideWorldBounds=!0,this.sprite.body.gravity.y=500,this.sprite.body.maxVelocity.y=500;var a=.9*this.sprite.body.width,b=this.sprite.body.height-60;this.sprite.body.setSize(a,b,.1*this.sprite.body.width,60),this.projectiles.setAll("body.gravity.y",500),this.projectiles.setAll("body.bounce.y",.3)},update:function(){if(!redrum.is_active&&(game.time.now>this.jumpTimer&&!this.anim_busy&&(this.anim_jump.play(),this.anim_busy=!0,this.jumpTimer=game.time.now+this.JUMP_DELAY+game.rnd.integerInRange(0,2e3)),game.time.now>this.shootTimer&&!this.anim_busy&&!winnicki.isDead)){this.double_throw||Math.random()<.5?(this.anim_throw_frame=0,this.anim_throw.play(),this.anim_busy=!0,this.double_throw=!1):this.shoot();var a=Math.max(this.MIN_DELAY,this.current_shoot_delay());Math.random()<.1&&(this.double_throw=!0,a=game.rnd.integerInRange(400,800)),this.shootTimer=game.time.now+a}},current_shoot_delay:function(){var a;return a=konferencja.level<3?konferencja.level*this.DELAY_STEP:2*this.DELAY_STEP+(konferencja.level-2)*this.DELAY_STEP/2,this.SHOOT_DELAY-a},throwit:function(){2==this.anim_throw_frame&&(p=this.projectiles.getFirstExists(!1),p&&(p.reset(this.sprite.x+2*this.sprite.width/3,this.sprite.y+220),p.body.velocity.x=-this.THROW_SPEED,p.scale.setTo(.3,.3),p.scale_up.start(),sounds_ready&&this.snd_horse_walk.fadeIn(1500,!0))),this.anim_throw_frame+=1},make_jump:function(){this.sprite.body.velocity.x=2*game.rnd.integerInRange(-100,100),this.sprite.body.velocity.y=-300,sounds_ready&&snd_boing.play()},shoot:function(){sounds_ready&&(bullet=this.bullets.getFirstExists(!1),bullet&&(bullet.reset(this.sprite.x+this.sprite.width/2,this.sprite.y+30),bullet.body.velocity.x=-this.LASER_SPEED,this.snd_shot.play()))},touchedByGuy:function(a,b){!sounds_ready||this.snd_player_touch.isPlaying||this.anim_busy||(this.snd_player_touch.play(),this.anim_scream.play(),this.anim_busy=!0)},projectileGotHit:function(a,b){b.body.collideWorldBounds=!1,b.body.velocity.y=0,a.kill(),sounds_ready&&this.snd_splat.play(),winnicki.splash_enemy_projectile(b),score+=winnicki.KILL_PROJECTILE_BONUS}},score_text={create:function(){this.score_name=game.add.text(10,528,"Wielka",{font:"28px Dimis",fill:"#fff"}),this.score_name_2=game.add.text(10,565,"Polska",{font:"28px Dimitri",fill:"#e00"}),this.score_name.addColor("rgb(200, 0, 0)",6),this.score_val=game.add.text(110,526,"",{font:"76px Dimitri",fill:"#fff"}),this.score_unit=game.add.text(this.unit_pos_x(),565,"KM",{font:"bold 22px Dimis",fill:"#fff"})},unit_pos_x:function(){return 110+this.score_val.width+10},update:function(){this.score_val.text=""+score,this.score_unit.x=this.unit_pos_x()},show:function(a){game.add.tween(this.score_name).to({alpha:1},300,Phaser.Easing.Quadratic.In).start(),game.add.tween(this.score_name_2).to({alpha:1},300,Phaser.Easing.Quadratic.In).start(),game.add.tween(this.score_val).to({alpha:1},300,Phaser.Easing.Quadratic.In).start(),game.add.tween(this.score_unit).to({alpha:1},300,Phaser.Easing.Quadratic.In).start(),a&&(score=0)},hide:function(){game.add.tween(this.score_name).to({alpha:0},300,Phaser.Easing.Quadratic.Out).start(),game.add.tween(this.score_name_2).to({alpha:0},300,Phaser.Easing.Quadratic.Out).start(),game.add.tween(this.score_val).to({alpha:0},300,Phaser.Easing.Quadratic.Out).start(),game.add.tween(this.score_unit).to({alpha:0},300,Phaser.Easing.Quadratic.Out).start()},reset:function(){this.show()}},game_over_screen={x:380,y:50,phase_in_time:500,active:!1,inputsEnabled:!1,score_counter:0,ding_time:0,create:function(){this.background=game.add.graphics(0,0),this.background.beginFill(0,.85),this.background.drawRect(0,0,game.world.width,game.world.height),this.banner=game.add.sprite(this.x,this.y,"game_over"),this.banner.anchor.x=.5;var a="DEGRENGOLADA I TARGOWICA ZWYCIĘŻYŁY\nALE WYSIŁEK RYCERZY PRAWOŚCI\nNIE PÓJDZIE NA MARNE!",b={font:"20px Arial",fill:"#fff",align:"center",fontWeight:"bold",boundsAlignH:"center",boundsAlignV:"top"};this.text=game.add.text(this.x,215,a,b),this.text.anchor.x=.5,this.big_score=game.add.text(this.x,350,"0",{font:"96px Dimis",fill:"#e22",align:"center",fontWeight:"bold",boundsAlignH:"center",boundsAlignV:"top"}),this.big_score.anchor.x=.5;var c="NACIŚNIJ SPACJĘ I UCZYŃ POLSKĘ\nJESZCZE WIĘKSZĄ!";this.text_space=game.add.text(this.x,500,c,b),this.text_space.anchor.x=.5,this.background.visible=!1,this.banner.visible=!1,this.text.visible=!1,this.big_score.visible=!1,this.text_space.visible=!1},update:function(){this.active&&(this.big_score.text=""+Math.round(this.score_counter),game.time.now>this.ding_time&&this.score_counter<score&&(winnicki.snd_ding.play(),this.ding_time=game.time.now+150),this.inputsEnabled&&controller.isFire()&&(this.inputsEnabled=!1,this.hide()))},show:function(){score_text.hide(),this.background.visible=!0,this.background.alpha=0,game.add.tween(this.background).to({alpha:1},this.phase_in_time,Phaser.Easing.Quadratic.In).start(),this.banner.visible=!0,this.banner.alpha=0,game.add.tween(this.banner).to({alpha:1},this.phase_in_time,Phaser.Easing.Quadratic.In).start(),this.text.visible=!0,this.text.alpha=0,game.add.tween(this.text).to({alpha:1},this.phase_in_time,Phaser.Easing.Quadratic.In).start(),this.big_score.visible=!0,this.big_score.alpha=0,game.add.tween(this.big_score).to({alpha:1},this.phase_in_time,Phaser.Easing.Quadratic.In).start(),this.text_space.visible=!0,this.text_space.alpha=0;var a=game.add.tween(this.text_space).to({alpha:1},this.phase_in_time,Phaser.Easing.Quadratic.In);controller.hide(),a.onComplete.add(function(){this.active=!0,this.start_counting_score()},this),a.start()},start_counting_score:function(){this.score_counter=0;var a=game.add.tween(this).to({score_counter:score},2e3);a.onComplete.add(function(){this.inputsEnabled=!0},this),a.start()},hide:function(){score_text.show(!0),game.add.tween(this.background).to({alpha:0},this.phase_in_time,Phaser.Easing.Quadratic.Out).start(),game.add.tween(this.banner).to({alpha:0},this.phase_in_time,Phaser.Easing.Quadratic.Out).start(),game.add.tween(this.text).to({alpha:0},this.phase_in_time,Phaser.Easing.Quadratic.Out).start(),game.add.tween(this.big_score).to({alpha:0},this.phase_in_time,Phaser.Easing.Quadratic.Out).start();var a=game.add.tween(this.text_space).to({alpha:0},this.phase_in_time,Phaser.Easing.Quadratic.Out);a.onComplete.add(function(){this.background.visible=!1,this.banner.visible=!1,this.text.visible=!1,this.text_space.visible=!1,this.active=!1},this),a.start(),game.time.events.add(.5*Phaser.Timer.SECOND,konferencja.reset_game,konferencja)}},konferencja={level:0,setup_globals:function(){all_sounds=[],sounds_ready=!1,score=0},create:function(){this.setup_globals(),game.physics.startSystem(Phaser.Physics.ARCADE),game.stage.backgroundColor="#303030",this.background=game.add.tileSprite(0,0,800,600,"background"),redrum.create(),krucjator.create(),winnicki.create(),girl.create(),collectables.create(),collectable_health.create(),game_over_screen.create(),score_text.create(),controller.setup(),snd_boing=game.add.audio("boing"),all_sounds.push(snd_boing),game.sound.setDecodedCallback(all_sounds,function(){sounds_ready=!0},this),scene=game.add.sprite(-2,535,"scene"),this.health=game.add.sprite(580,560,"health"),this.health.crop(new Phaser.Rectangle(0,0,winnicki.MAX_HEALTH,30)),game.physics.arcade.enable([scene]),game.physics.arcade.gravity.y=300,scene.body.allowGravity=!1,scene.body.immovable=!0,winnicki.init_physics(),girl.init_physics(),krucjator.init_physics(),redrum.init_physics(),collectables.init_physics(),collectable_health.init_physics(),cursors=game.input.keyboard.createCursorKeys(),keyShoot=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)},update:function(){0==winnicki.isDead&&(game.physics.arcade.collide(winnicki.sprite,scene,winnicki.touchedGround,null,winnicki),game.physics.arcade.collide(winnicki.sprite,girl.sprite,girl.touchedByGuy,null,girl),game.physics.arcade.collide(winnicki.sprite,girl.bullets,winnicki.hitByBullet,null,winnicki),game.physics.arcade.collide(winnicki.sprite,girl.projectiles,winnicki.hitByProjectile,null,winnicki),game.physics.arcade.overlap(winnicki.sprite,collectables.sprite,winnicki.gotCollectable,null,winnicki),game.physics.arcade.overlap(winnicki.sprite,collectable_health.sprite,winnicki.gotHealth,null,winnicki)),game.physics.arcade.collide(girl.sprite,scene),game.physics.arcade.collide(girl.projectiles,scene),game.physics.arcade.overlap(redrum.midget,winnicki.projectiles,redrum.spit_hits_midget,null,redrum),game.physics.arcade.collide(winnicki.projectiles,scene,winnicki.shot_hit_something,null,winnicki),game.physics.arcade.overlap(winnicki.projectiles,girl.bullets,winnicki.shot_hit_shot,null,winnicki),game.physics.arcade.collide(collectable_health.sprite,scene,collectable_health.hit_ground,null,collectable_health),game.physics.arcade.overlap(winnicki.projectiles,girl.projectiles,girl.projectileGotHit,null,girl),0==winnicki.isDead&&winnicki.update(),girl.update(),krucjator.update(),redrum.update(),collectables.update(),collectable_health.update(),score_text.update(),game_over_screen.update(),this.health.cropRect.width=winnicki.health,this.health.updateCrop()},hide_health:function(){game.add.tween(this.health).to({alpha:0},500,Phaser.Easing.Quadratic.Out).start()},show_health:function(){game.add.tween(this.health).to({alpha:1},500,Phaser.Easing.Quadratic.In).start()},reset_game:function(){this.level=0,collectables.reset(),collectable_health.reset(),winnicki.reset(),krucjator.reset(),girl.reset(),redrum.reset(),score_text.reset(),this.show_health(),controller.reset()},render:function(){}},backend=Phaser.AUTO,gameDivId="game-container",game,Loader;$.browser.mozilla&&(backend=Phaser.CANVAS),$(document).ready(function(){$(".start-game").on("click",function(){start()}),$("button.uk-modal-close.uk-close").on("click",function(){game.destroy()}),$(document).keyup(function(a){27===a.keyCode&&game&&game.destroy&&game.destroy()})});